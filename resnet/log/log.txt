2022-10-13 14:46:59,129 args = Namespace(batch_size=256, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=128, label_smooth=0.1, learning_rate=0.00125, momentum=0.9, n_bit=2, quantize_downsample='0', save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 14:47:01,170 student:
2022-10-13 14:47:01,170 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 15:38:28,517 args = Namespace(batch_size=256, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=128, label_smooth=0.1, learning_rate=0.00125, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit.pth.tar', momentum=0.9, n_bit=2, quantize_downsample='0', save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 15:38:32,790 student:
2022-10-13 15:38:32,791 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 15:38:33,630 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit.pth.tar ..........
2022-10-13 15:38:58,790 args = Namespace(batch_size=256, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=128, label_smooth=0.1, learning_rate=0.00125, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, quantize_downsample='0', save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 15:39:03,063 student:
2022-10-13 15:39:03,064 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 15:39:03,900 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 15:39:04,724 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 15:40:09,641 args = Namespace(batch_size=256, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=128, label_smooth=0.1, learning_rate=0.00125, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, quantize_downsample='0', save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 15:40:13,894 student:
2022-10-13 15:40:13,894 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 15:40:14,732 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 15:40:15,565 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 15:42:15,345 args = Namespace(batch_size=256, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=128, label_smooth=0.1, learning_rate=0.00125, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, quantize_downsample='0', save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 15:42:17,919 student:
2022-10-13 15:42:17,919 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 15:42:17,993 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 15:42:18,080 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 15:44:50,210 args = Namespace(batch_size=256, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=128, label_smooth=0.1, learning_rate=0.00125, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, quantize_downsample='0', save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 15:44:52,429 student:
2022-10-13 15:44:52,429 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 15:44:52,476 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 15:44:52,536 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 17:07:11,203 args = Namespace(batch_size=256, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=1.25e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 17:07:15,106 student:
2022-10-13 17:07:15,107 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 17:07:15,665 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 17:07:16,329 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 17:08:01,566 args = Namespace(batch_size=256, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=1.25e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 17:08:05,613 student:
2022-10-13 17:08:05,614 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 17:08:05,767 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 17:08:06,427 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 17:09:32,915 args = Namespace(batch_size=256, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=1.25e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 17:09:36,952 student:
2022-10-13 17:09:36,953 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 17:09:37,485 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 17:09:38,149 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 17:11:28,318 args = Namespace(batch_size=256, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=1.25e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 17:11:31,945 student:
2022-10-13 17:11:31,945 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 17:11:32,449 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 17:11:33,143 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 17:12:15,830 args = Namespace(batch_size=256, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=1.25e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 17:12:19,675 student:
2022-10-13 17:12:19,676 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 17:12:20,198 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 17:12:20,867 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 17:12:33,454 args = Namespace(batch_size=256, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=1.25e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 17:12:37,285 student:
2022-10-13 17:12:37,285 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 17:12:37,827 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 17:12:38,491 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 17:14:40,722 args = Namespace(batch_size=256, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=1.25e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 17:14:44,757 student:
2022-10-13 17:14:44,758 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 17:14:44,960 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 17:14:45,625 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 17:20:19,365 args = Namespace(batch_size=768, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=3.75e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 17:20:23,444 student:
2022-10-13 17:20:23,445 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 17:20:24,109 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 17:20:24,773 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 17:22:11,090 args = Namespace(batch_size=512, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 17:22:14,971 student:
2022-10-13 17:22:14,972 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 17:22:15,450 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 17:22:16,139 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 18:54:52,471 args = Namespace(batch_size=512, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 18:54:59,563 args = Namespace(batch_size=512, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 18:55:12,350 args = Namespace(batch_size=512, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 18:55:40,491 args = Namespace(batch_size=512, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 18:56:08,132 args = Namespace(batch_size=512, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 18:56:26,961 args = Namespace(batch_size=512, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 19:04:26,154 args = Namespace(batch_size=512, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 19:04:28,334 student:
2022-10-13 19:04:28,335 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 19:04:28,380 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 19:04:28,457 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 19:41:27,944 args = Namespace(batch_size=512, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 19:41:30,481 student:
2022-10-13 19:41:30,482 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 19:41:30,527 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 19:41:30,577 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 19:42:17,575 args = Namespace(batch_size=512, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 19:42:19,877 student:
2022-10-13 19:42:19,877 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 19:42:19,925 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 19:42:19,984 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 22:07:52,653 args = Namespace(batch_size=512, boundaryRange=0.005, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=5, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 22:07:55,104 student:
2022-10-13 22:07:55,105 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 22:07:55,156 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 22:07:55,235 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-13 23:58:40,463 args = Namespace(batch_size=512, boundaryRange=0.01, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=5, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-13 23:58:42,891 student:
2022-10-13 23:58:42,891 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-13 23:58:42,934 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-13 23:58:42,990 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-14 01:48:26,332 args = Namespace(batch_size=512, boundaryRange=0.0001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center_less_aggro/', quantize_downsample='0', random_method='bin_center_less_aggro', random_prob=0.0, sample_time=5, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-14 01:48:28,428 student:
2022-10-14 01:48:28,429 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-14 01:48:28,472 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-14 01:48:28,521 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-14 03:39:37,986 args = Namespace(batch_size=512, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center/', quantize_downsample='0', random_method='bin_center', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-14 03:39:40,283 student:
2022-10-14 03:39:40,283 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-14 03:39:40,328 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-14 03:39:40,378 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-14 03:39:44,500 args = Namespace(batch_size=512, boundaryRange=0.005, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center/', quantize_downsample='0', random_method='bin_center', random_prob=0.0, sample_time=5, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-14 03:39:47,084 student:
2022-10-14 03:39:47,085 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-14 03:39:47,126 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-14 03:39:47,178 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-14 03:39:51,327 args = Namespace(batch_size=512, boundaryRange=0.01, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center/', quantize_downsample='0', random_method='bin_center', random_prob=0.0, sample_time=5, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-14 03:39:53,240 student:
2022-10-14 03:39:53,241 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-14 03:39:53,281 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-14 03:39:53,329 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-14 03:39:57,641 args = Namespace(batch_size=512, boundaryRange=0.0001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center/', quantize_downsample='0', random_method='bin_center', random_prob=0.0, sample_time=5, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-14 03:40:00,352 student:
2022-10-14 03:40:00,352 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-14 03:40:00,390 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-14 03:40:00,441 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
2022-10-14 10:59:14,839 args = Namespace(batch_size=512, boundaryRange=0.001, data='/home/sliuau/ternary_vit/dataset/imagenet-1k/imagenet', epochs=1, label_smooth=0.1, learning_rate=2.5e-05, load_pretrained_weight_student='/home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar', momentum=0.9, n_bit=2, output_dir='/home/sliuau/nu2uq/resnet/resnet_noise_inj/bin_center/', quantize_downsample='0', random_method='bin_center', random_prob=0.0, sample_time=50, save='./models', student='resnet18', teacher='resnet101', weight_decay=0.0, workers=40)
2022-10-14 10:59:16,941 student:
2022-10-14 10:59:16,941 ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU(inplace=True)
  (maxpool): MaxPool2d(kernel_size=3, stride=2, padding=1, dilation=1, ceil_mode=False)
  (layer1): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=64)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=64)
      (bias32): LearnableBias()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=64)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=128)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=128)
      (bias32): LearnableBias()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=128)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=256)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=256)
      (bias32): LearnableBias()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=256)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (downsample): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
    (1): BasicBlock(
      (bias11): LearnableBias()
      (prelu1): PReLU(num_parameters=512)
      (bias12): LearnableBias()
      (quan1): LTQ()
      (conv1): HardQuantizeConv()
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias21): LearnableBias()
      (prelu2): PReLU(num_parameters=512)
      (bias22): LearnableBias()
      (quan2): LTQ()
      (conv2): HardQuantizeConv()
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (bias31): LearnableBias()
      (prelu3): PReLU(num_parameters=512)
      (bias32): LearnableBias()
    )
  )
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
  (fc): Linear(in_features=512, out_features=1000, bias=True)
)
2022-10-14 10:59:16,983 loading checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar ..........
2022-10-14 10:59:17,035 loaded checkpoint /home/sliuau/nu2uq/resnet/models/res18-2bit_star.pth.tar epoch = 127
